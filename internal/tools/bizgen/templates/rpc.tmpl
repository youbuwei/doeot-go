// Code generated by bizgen; DO NOT EDIT.
package rpc

import (
	"encoding/json"

	"{{ .ModPath }}/internal/{{ .Module }}/interfaces/endpoint"
	"{{ .ModPath }}/pkg/biz"
	"{{ .ModPath }}/pkg/errs"
	"{{ .ModPath }}/pkg/validate"
)

// RegisterRPC is generated from endpoint annotations.
func RegisterRPC(r biz.RPCRouter, ep *endpoint.{{ .EndpointType }}) {
{{- range .Endpoints }}
	r.Handle("{{ .RPCMethod }}", func(ctx biz.Context, raw json.RawMessage) (any, error) {
		var req endpoint.{{ .MethodName }}Req
		if err := json.Unmarshal(raw, &req); err != nil {
			return nil, errs.BadRequest("invalid params").WithCause(err)
		}
		if err := validate.Struct(&req); err != nil {
			return nil, err
		}
		return ep.{{ .MethodName }}(ctx, &req)
	}{{ if .Options }}, {{ .Options }}{{ end }})
{{- end }}
}
